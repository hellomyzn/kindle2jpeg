# Kindle Screenshot Automation Script
> 重要
> 本ツールおよび本READMEは、個人的な利用（非営利・非商用）にのみ使用可能です。
> 研究・学習・私的利用の範囲でお使いください。
> コピーや改変を行って使用する場合も、個人での活動に限ります。 組織/企業/団体での利用、商用利用、配布・再配布は行わないでください。

このAppleScriptは、macOS上で**Kindleアプリの指定範囲を自動でスクリーンショット**するためのツールです。本の名前（フォルダ名）とページ数を指定するだけで、ページ送りから保存まで自動で行います。

---

## 📦 概要

Kindleアプリをアクティブにして、指定範囲を連続キャプチャします。各ページは自動的に進み、指定フォルダ内に保存されます。

スクリーンショットは macOS 標準コマンド `screencapture` を使用します。

---

## ⚙️ 前提条件

* macOS（推奨: macOS Monterey 以降）
* Kindle アプリがインストール済みであること
* システム環境設定 > セキュリティとプライバシー > アクセシビリティ において、
  「スクリプトエディタ」または「osascript」にアクセス許可を付与

---

## 🧩 スクリプトの配置

1. 下記のファイル名で保存します：

   ```bash
   kindle2jpeg.scpt
   ```

2. 保存場所は任意ですが、例として `~/scripts/kindle2jpeg.scpt` とします。

3. 実行権限は不要です。`osascript` コマンドで直接実行できます。

---

## 🚀 使い方

```bash
osascript kindle2jpeg.scpt [options]
```

### オプション一覧

| オプション           | 説明                   | 例                    |
| --------------- | -------------------- | -------------------- |
| `-b`, `--book`  | 本の名前（フォルダ名・ファイル名に使用） | `--book "Deep Work"` |
| `-p`, `--pages` | 撮影するページ数             | `--pages 25`         |
| `-h`, `--help`  | 使い方を表示               | `-h`                 |

### 例

```bash
osascript kindle2jpeg.scpt -b "Atomic Habits" -p 20
```

➡ `/Users/<USERNAME>/screen shots/KindleScreenshots/Atomic Habits/` に以下のように保存：

```
Atomic Habits_Page1.jpg
Atomic Habits_Page2.jpg
...
Atomic Habits_Page20.jpg
```

引数を省略した場合：

```bash
osascript kindle2jpeg.scpt
```

デフォルト設定で動作します。

* Book Name: `Untitled Bookname`
* Pages: `0`


### 例 (Makefile)
Makefileからも実行可能です。
```bash
make run b="Book Title" p=100
```

---

## 🪟 設定パラメータ（スクリプト内部）

| 変数名                | 説明                               | 既定値                                                   |
| ------------------ | -------------------------------- | ----------------------------------------------------- |
| `saveToLocation`   | 保存先フォルダの親ディレクトリ                  | `/Users/<USERNAME>/screen shots/KindleScreenshots/` |
| `screenshotRegion` | スクリーンショット範囲（x, y, width, height） | `{84, 88, 678, 952}`                                  |
| `windowPosition`   | Kindleウィンドウ位置（x, y）              | `{10, 60}`                                            |
| `windowSize`       | Kindleウィンドウサイズ（width, height）    | `{827, 980}`                                          |
| `pageKeyCode`      | ページ送りキーコード（125 = 下矢印）            | `125`                                                 |

---

## ⚠️ 注意事項

* Kindleウィンドウは自動的に左上へ配置・サイズ固定されます。
* ページ送りは**下矢印キー**（`key code 125`）で行います。

  * ページ送りが効かない場合は、Kindleアプリの設定で確認してください。
* 連続キャプチャのため、macOSの操作を控えることを推奨します。

---

## 💡 トラブルシューティング

| 問題                  | 対処                                                   |
| ------------------- | ---------------------------------------------------- |
| 「Kindleアプリが見つかりません」 | アプリ名が「Amazon Kindle」であることを確認。日本語ローカライズ版では異なる場合があります。 |
| 「保存フォルダの作成に失敗」      | 保存先ディレクトリの権限を確認してください。                               |
| 「スクリーンショットの取得に失敗」   | macOSのアクセシビリティとスクリーン録画権限を確認。                         |

---

## 🧠 ヒント

* スクリプトを Automator でアプリ化すれば、ダブルクリックで実行できます。
* `cron` や `launchd` と組み合わせて自動化も可能です。

---

## 🪄 作者メモ

> Kindle本を効率的にアーカイブしたり、リサーチ資料を作るためのツールとして開発。
> シンプルなオプションで柔軟に使えるよう設計しています。

---

## 📜 ライセンス / 利用条件・免責事項（必読）

- 利用範囲：本ツールおよび本READMEは個人的な利用（非営利・非商用）に限定します。
組織・企業・団体での利用、商用利用、再配布・再販売、SaaS化、社内共有を含む配布行為は禁止です。

- コピー/改変について：本READMEやスクリプトをコピー・改変して使用する場合も、必ず個人の活動に限って使用してください。公開・配布する場合はこの注意文をそのまま同梱してください。

- 著作権と規約順守：本ツールはDRM回避や著作物の無断複製・配布を目的としたものではありません。スクリーンショットの取得・保存・共有は、Kindle/各サービスの利用規約および各国の著作権法を遵守してください。第三者への配布や公開を行う場合は著作権者の許諾を得てください。

- 自己責任：本ツールの利用により生じたいかなる損害・トラブルについても、作者は一切の責任を負いません。ご自身の責任にてご利用ください。

- 保証なし：本ツールは現状有姿（AS IS）で提供され、いかなる明示または黙示の保証も行いません。